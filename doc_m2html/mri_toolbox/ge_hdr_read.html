<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ge_hdr_read</title>
  <meta name="keywords" content="ge_hdr_read">
  <meta name="description" content="ge_hdr_read - Reads the header info from a GE LX2 or 5.X file">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">mri_toolbox</a> &gt; ge_hdr_read.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mri_toolbox&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>ge_hdr_read
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>ge_hdr_read - Reads the header info from a GE LX2 or 5.X file</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [ ge ] = ge_hdr_read(imageFileName) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> ge_hdr_read - Reads the header info from a GE LX2 or 5.X file
 
 [ge,im_offset] = ge_hdr_read('imageFileName')

 ge is a struct with fields:
 
 ge.hdr.suite  - suite header
 ge.hdr.exam   - exam header
 ge.hdr.series - series header
 ge.hdr.image  - image header
 ge.hdr.pixel  - pixel header
 
 ge.img.offset  - the byte offset to the image data
 
 This function assumes the image file is big endian.  It can
 automatically determine LX2 format (SGI) and 5.X format (Sun);
 other formats fail.
 
 See also ge_vol_read</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="ge_series_read.html" class="code" title="function [ ge, lastfile ] = ge_series_read(examPath, series)">ge_series_read</a>	ge_series_read - reads a volume of images from a GE series</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function su_hdr = ge_readHeaderSuite(fid, byte_align)</a></li><li><a href="#_sub2" class="code">function ex_hdr = ge_readHeaderExam(fid, byte_align)</a></li><li><a href="#_sub3" class="code">function se_hdr = ge_readHeaderSeries(fid, byte_align)</a></li><li><a href="#_sub4" class="code">function im_hdr = ge_readHeaderImage(fid, byte_align)</a></li><li><a href="#_sub5" class="code">function ge = ge_readHeaderPixel(fid, byte_align, ge)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [ ge ] = ge_hdr_read(imageFileName)</a>
0002 
0003 <span class="comment">% ge_hdr_read - Reads the header info from a GE LX2 or 5.X file</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% [ge,im_offset] = ge_hdr_read('imageFileName')</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% ge is a struct with fields:</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% ge.hdr.suite  - suite header</span>
0010 <span class="comment">% ge.hdr.exam   - exam header</span>
0011 <span class="comment">% ge.hdr.series - series header</span>
0012 <span class="comment">% ge.hdr.image  - image header</span>
0013 <span class="comment">% ge.hdr.pixel  - pixel header</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% ge.img.offset  - the byte offset to the image data</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% This function assumes the image file is big endian.  It can</span>
0018 <span class="comment">% automatically determine LX2 format (SGI) and 5.X format (Sun);</span>
0019 <span class="comment">% other formats fail.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% See also ge_vol_read</span>
0022 <span class="comment">%</span>
0023 
0024 
0025 <span class="comment">% $Revision: 1.2 $ $Date: 2004/04/08 20:11:24 $</span>
0026 
0027 <span class="comment">% Souheil J. Inati  &lt;souheil.inati@nyu.edu&gt; at 03/2003</span>
0028 <span class="comment">% Dartmouth College, May 2000</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% Darren.Weber_at_radiology.ucsf.edu, March 2003</span>
0031 <span class="comment">% - Substantially redesigned file handling and function</span>
0032 <span class="comment">%   call structures for integration with mri_toolbox at</span>
0033 <span class="comment">%   http://eeg.sf.net</span>
0034 <span class="comment">% - Requested permission to distribute code under GPL licence</span>
0035 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0036 
0037 
0038 <span class="comment">% DLW, found this note in an FSL list message:</span>
0039 <span class="comment">%This is further confounded by the GE image format I.001 or I.MR</span>
0040 <span class="comment">%formats where the data following the header is inverted (top of the</span>
0041 <span class="comment">%image for bottom).</span>
0042 
0043 
0044 
0045 fprintf(<span class="string">'\nGE_HDR_READ\n'</span>); tic
0046 
0047 fprintf(<span class="string">'...reading %s\n'</span>,imageFileName);
0048 
0049 <span class="comment">% Open the Image File</span>
0050 [fid,message] = fopen(imageFileName,<span class="string">'r'</span>,<span class="string">'b'</span>); <span class="comment">% 'b' = Big-Endian format</span>
0051 <span class="keyword">if</span> fid == -1, error(message); <span class="keyword">end</span>
0052 
0053 <span class="comment">% Check for the magic number at the first word</span>
0054 magic = fread(fid,1,<span class="string">'int32'</span>);
0055 <span class="keyword">if</span> magic == 1229801286,
0056     <span class="comment">% This is a 5.X format image</span>
0057     fprintf(<span class="string">'...identified Signa 5.X format\n'</span>);
0058     byte_align = 0;
0059     ge.hdr.pixel.offset = 0;
0060     ge.hdr.suite.size   = 114;
0061     ge.hdr.exam.size    = 1024;
0062     ge.hdr.series.size  = 1020;
0063     ge.hdr.image.size   = 1022;
0064 <span class="keyword">else</span>
0065     <span class="comment">% Magic no. not at the 1st word, try at the LX2 position</span>
0066     fseek(fid,3228,-1);
0067     magic = fread(fid,1,<span class="string">'int32'</span>);
0068     <span class="keyword">if</span> magic == 1229801286,
0069         <span class="comment">% This is an LX2 format image</span>
0070         fprintf(<span class="string">'...identified LX2 format\n'</span>);
0071         byte_align = 1;
0072         ge.hdr.pixel.offset = 3228;
0073         ge.hdr.suite.size   = 116;
0074         ge.hdr.exam.size    = 1040;
0075         ge.hdr.series.size  = 1028;
0076         ge.hdr.image.size   = 1044;
0077     <span class="keyword">else</span>
0078         msg = <span class="string">'This is not a 5.X or LX2 format image.  No Magic Number.'</span>;
0079         error(msg);
0080     <span class="keyword">end</span>
0081 <span class="keyword">end</span>
0082 
0083 <span class="comment">% Load the pixel header</span>
0084 fseek(fid,ge.hdr.pixel.offset,-1);
0085 ge = <a href="#_sub5" class="code" title="subfunction ge = ge_readHeaderPixel(fid, byte_align, ge)">ge_readHeaderPixel</a>(fid, byte_align, ge); <span class="comment">% see subfunc below</span>
0086 
0087 
0088 <span class="comment">% Check for epirecon images</span>
0089 <span class="keyword">if</span> (ge.hdr.pixel.img_l_dbHdr == 0 &amp; byte_align == 0),
0090     error(<span class="string">'This is an epirecon image. No header!'</span>);
0091 <span class="keyword">end</span>
0092 
0093 <span class="comment">% Compute the offsets</span>
0094 ge.hdr.suite.offset  = ge.hdr.pixel.img_p_dbHdr;
0095 ge.hdr.exam.offset   = ge.hdr.suite.offset  + ge.hdr.suite.size;
0096 ge.hdr.series.offset = ge.hdr.exam.offset   + ge.hdr.exam.size;
0097 ge.hdr.image.offset  = ge.hdr.series.offset + ge.hdr.series.size;
0098 ge.img.offset        = ge.hdr.pixel.offset  + ge.hdr.pixel.img_hdr_length;
0099 
0100 
0101 
0102 <span class="comment">% Load the suite header</span>
0103 fseek(fid,ge.hdr.suite.offset,-1);
0104 ge.hdr.suite = <a href="#_sub1" class="code" title="subfunction su_hdr = ge_readHeaderSuite(fid, byte_align)">ge_readHeaderSuite</a>(fid, byte_align); <span class="comment">% see subfunc below</span>
0105 
0106 <span class="comment">% Load the exam header</span>
0107 fseek(fid,ge.hdr.exam.offset,-1);
0108 ge.hdr.exam = <a href="#_sub2" class="code" title="subfunction ex_hdr = ge_readHeaderExam(fid, byte_align)">ge_readHeaderExam</a>(fid, byte_align); <span class="comment">% see subfunc below</span>
0109 
0110 <span class="comment">% Load the series header</span>
0111 fseek(fid,ge.hdr.series.offset,-1);
0112 ge.hdr.series = <a href="#_sub3" class="code" title="subfunction se_hdr = ge_readHeaderSeries(fid, byte_align)">ge_readHeaderSeries</a>(fid, byte_align); <span class="comment">% see subfunc below</span>
0113 
0114 <span class="comment">% Load the image header</span>
0115 fseek(fid,ge.hdr.image.offset,-1);
0116 ge.hdr.image = <a href="#_sub4" class="code" title="subfunction im_hdr = ge_readHeaderImage(fid, byte_align)">ge_readHeaderImage</a>(fid, byte_align); <span class="comment">% see subfunc below</span>
0117 
0118 <span class="comment">% Close the file</span>
0119 fclose(fid);
0120 
0121 t=toc; fprintf(<span class="string">'...done (%5.2f sec).\n'</span>,t);
0122 
0123 <span class="keyword">return</span>
0124 
0125 
0126 
0127 
0128 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0129 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0130 <a name="_sub1" href="#_subfunctions" class="code">function su_hdr = ge_readHeaderSuite(fid, byte_align)</a>
0131 
0132 <span class="comment">% Loads the suite header from an image file (with fid)</span>
0133 <span class="comment">% and returns it as a structure.</span>
0134 <span class="comment">%</span>
0135 <span class="comment">% if byte_align = 1 then 32-bit alignment (SGI, LX2 format)</span>
0136 <span class="comment">% if byte_align = 0 then 16-bit alignment (Sun, 5.X format)</span>
0137 
0138 <span class="comment">% define the structure and read</span>
0139 su_hdr = struct(<span class="string">'su_id'</span>, fread(fid,4,<span class="string">'char'</span>));                   <span class="comment">% Suite ID</span>
0140 su_hdr = setfield(su_hdr, <span class="string">'su_uniq'</span>, fread(fid,1,<span class="string">'int16'</span>));      <span class="comment">% The Make-Unique Flag</span>
0141 su_hdr = setfield(su_hdr, <span class="string">'su_diskid'</span>, fread(fid,1,<span class="string">'char'</span>));     <span class="comment">% Disk ID</span>
0142 su_hdr = setfield(su_hdr, <span class="string">'prodid'</span>, fread(fid,13,<span class="string">'char'</span>));       <span class="comment">% Product ID</span>
0143 su_hdr = setfield(su_hdr, <span class="string">'su_verscre'</span>, fread(fid,2,<span class="string">'char'</span>));    <span class="comment">% Genesis Version</span>
0144 su_hdr = setfield(su_hdr, <span class="string">'su_verscur'</span>, fread(fid,2,<span class="string">'char'</span>));    <span class="comment">% Genesis Version</span>
0145 su_hdr = setfield(su_hdr, <span class="string">'su_checksum'</span>, fread(fid,1,<span class="string">'uint32'</span>)); <span class="comment">% Suite Record Checksum</span>
0146 su_hdr = setfield(su_hdr, <span class="string">'su_padding'</span>, fread(fid,85,<span class="string">'char'</span>));   <span class="comment">% Spare Space</span>
0147 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0148 <span class="keyword">if</span> byte_align, fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0149 
0150 <span class="keyword">return</span>
0151 
0152 
0153 
0154 
0155 
0156 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0157 
0158 <a name="_sub2" href="#_subfunctions" class="code">function ex_hdr = ge_readHeaderExam(fid, byte_align)</a>
0159 
0160 <span class="comment">% Loads the exam header from the image file</span>
0161 <span class="comment">% and returns it as a structure.</span>
0162 <span class="comment">%</span>
0163 <span class="comment">% if byte_align = 1 then 32-bit alignment (SGI, LX2 format)</span>
0164 <span class="comment">% if byte_align = 0 then 16-bit alignment (Sun, 5.X format)</span>
0165 
0166 <span class="comment">% define the structure and read ifseek(fid,1,0);  % byte align the data</span>
0167 <span class="comment">% to overcome the byte alignment problems</span>
0168 <span class="comment">% break up the assignment into pieces using the setfield function</span>
0169 ex_hdr = struct(<span class="string">'ex_suid'</span>, fread(fid,4,<span class="string">'uchar'</span>)); <span class="comment">%Suite ID for this Exam%</span>
0170 ex_hdr = setfield(ex_hdr, <span class="string">'ex_uniq'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%The Make-Unique Flag%</span>
0171 ex_hdr = setfield(ex_hdr, <span class="string">'ex_diskid'</span>, fread(fid,1,<span class="string">'uchar'</span>));      <span class="comment">%Disk ID for this Exam%</span>
0172 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0173 ex_hdr = setfield(ex_hdr, <span class="string">'ex_no'</span>, fread(fid,1,<span class="string">'uint16'</span>));         <span class="comment">%Exam Number%</span>
0174 ex_hdr = setfield(ex_hdr, <span class="string">'hospname'</span>, fread(fid,33,<span class="string">'uchar'</span>));      <span class="comment">%Hospital Name%</span>
0175 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0176 ex_hdr = setfield(ex_hdr, <span class="string">'detect'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Detector Type%</span>
0177 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0178 ex_hdr = setfield(ex_hdr, <span class="string">'numcells'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Number of cells in det%</span>
0179 ex_hdr = setfield(ex_hdr, <span class="string">'zerocell'</span>, fread(fid,1,<span class="string">'float32'</span>));     <span class="comment">%Cell number at theta%</span>
0180 ex_hdr = setfield(ex_hdr, <span class="string">'cellspace'</span>, fread(fid,1,<span class="string">'float32'</span>));    <span class="comment">%Cell spacing%</span>
0181 ex_hdr = setfield(ex_hdr, <span class="string">'srctodet'</span>, fread(fid,1,<span class="string">'float32'</span>));     <span class="comment">%Distance from source to detector%</span>
0182 ex_hdr = setfield(ex_hdr, <span class="string">'srctoiso'</span>, fread(fid,1,<span class="string">'float32'</span>));     <span class="comment">%Distance from source to iso%</span>
0183 ex_hdr = setfield(ex_hdr, <span class="string">'tubetyp'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Tube type%</span>
0184 ex_hdr = setfield(ex_hdr, <span class="string">'dastyp'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%DAS type%</span>
0185 ex_hdr = setfield(ex_hdr, <span class="string">'num_dcnk'</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%Number of Decon Kernals%</span>
0186 ex_hdr = setfield(ex_hdr, <span class="string">'dcn_len'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Number of elements in a Decon Kernal%</span>
0187 ex_hdr = setfield(ex_hdr, <span class="string">'dcn_density'</span>, fread(fid,1,<span class="string">'int16'</span>));    <span class="comment">%Decon Kernal density%</span>
0188 ex_hdr = setfield(ex_hdr, <span class="string">'dcn_stepsize'</span>, fread(fid,1,<span class="string">'int16'</span>));   <span class="comment">%Decon Kernal stepsize%</span>
0189 ex_hdr = setfield(ex_hdr, <span class="string">'dcn_shiftcnt'</span>, fread(fid,1,<span class="string">'int16'</span>));   <span class="comment">%Decon Kernal Shift Count%</span>
0190 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0191 ex_hdr = setfield(ex_hdr, <span class="string">'magstrength'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Magnet strength (in gauss)%</span>
0192 ex_hdr = setfield(ex_hdr, <span class="string">'patid'</span>, fread(fid,13,<span class="string">'uchar'</span>));         <span class="comment">%Patient ID for this Exam%</span>
0193 ex_hdr = setfield(ex_hdr, <span class="string">'patname'</span>, fread(fid,25,<span class="string">'uchar'</span>));       <span class="comment">%Patientsda Name%</span>
0194 ex_hdr = setfield(ex_hdr, <span class="string">'patage'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Patient Age (years, months or days)%</span>
0195 ex_hdr = setfield(ex_hdr, <span class="string">'patian'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Patient Age Notation%</span>
0196 ex_hdr = setfield(ex_hdr, <span class="string">'patsex'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Patient Sex%</span>
0197 ex_hdr = setfield(ex_hdr, <span class="string">'patweight'</span>, fread(fid,1,<span class="string">'int32'</span>));      <span class="comment">%Patient Weight%</span>
0198 ex_hdr = setfield(ex_hdr, <span class="string">'trauma'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Trauma Flag%</span>
0199 ex_hdr = setfield(ex_hdr, <span class="string">'hist'</span>, fread(fid,61,<span class="string">'uchar'</span>));          <span class="comment">%Patient History%</span>
0200 ex_hdr = setfield(ex_hdr, <span class="string">'reqnum'</span>, fread(fid,13,<span class="string">'uchar'</span>));        <span class="comment">%Requisition Number%</span>
0201 ex_hdr = setfield(ex_hdr, <span class="string">'ex_datetime'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Exam date/time stamp%</span>
0202 ex_hdr = setfield(ex_hdr, <span class="string">'refphy'</span>, fread(fid,33,<span class="string">'uchar'</span>));        <span class="comment">%Referring Physician%</span>
0203 ex_hdr = setfield(ex_hdr, <span class="string">'diagrad'</span>, fread(fid,33,<span class="string">'uchar'</span>));       <span class="comment">%Diagnostician/Radiologist%</span>
0204 ex_hdr = setfield(ex_hdr, <span class="string">'op'</span>, fread(fid,4,<span class="string">'uchar'</span>));             <span class="comment">%Operator%</span>
0205 ex_hdr = setfield(ex_hdr, <span class="string">'ex_desc'</span>, fread(fid,23,<span class="string">'uchar'</span>));       <span class="comment">%Exam Description%</span>
0206 ex_hdr = setfield(ex_hdr, <span class="string">'ex_typ'</span>, fread(fid,3,<span class="string">'uchar'</span>));         <span class="comment">%Exam Type%</span>
0207 ex_hdr = setfield(ex_hdr, <span class="string">'ex_format'</span>, fread(fid,1,<span class="string">'int16'</span>));      <span class="comment">%Exam Format%</span>
0208 <span class="keyword">if</span> byte_align; fseek(fid,6,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0209 ex_hdr = setfield(ex_hdr, <span class="string">'firstaxtime'</span>, fread(fid,1,<span class="string">'float64'</span>));  <span class="comment">%Start time(secs) of first axial in exam%</span>
0210 ex_hdr = setfield(ex_hdr, <span class="string">'ex_sysid'</span>, fread(fid,9,<span class="string">'uchar'</span>));       <span class="comment">%Creator Suite and Host%</span>
0211 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0212 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0213 ex_hdr = setfield(ex_hdr, <span class="string">'ex_lastmod'</span>, fread(fid,1,<span class="string">'int32'</span>));     <span class="comment">%Date/Time of Last Change%</span>
0214 ex_hdr = setfield(ex_hdr, <span class="string">'protocolflag'</span>, fread(fid,1,<span class="string">'int16'</span>));   <span class="comment">%Non-Zero indicates Protocol Exam%</span>
0215 ex_hdr = setfield(ex_hdr, <span class="string">'ex_alloc_key'</span>, fread(fid,13,<span class="string">'uchar'</span>));  <span class="comment">%Process that allocated this record%</span>
0216 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0217 ex_hdr = setfield(ex_hdr, <span class="string">'ex_delta_cnt'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">%Indicates number of updates to header%</span>
0218 ex_hdr = setfield(ex_hdr, <span class="string">'ex_verscre'</span>, fread(fid,2,<span class="string">'uchar'</span>));     <span class="comment">%Genesis Version - Created%</span>
0219 ex_hdr = setfield(ex_hdr, <span class="string">'ex_verscur'</span>, fread(fid,2,<span class="string">'uchar'</span>));     <span class="comment">%Genesis Version - Now%</span>
0220 ex_hdr = setfield(ex_hdr, <span class="string">'ex_checksum'</span>, fread(fid,1,<span class="string">'uint32'</span>));   <span class="comment">%Exam Record Checksum%</span>
0221 ex_hdr = setfield(ex_hdr, <span class="string">'ex_complete'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Exam Complete Flag%</span>
0222 ex_hdr = setfield(ex_hdr, <span class="string">'ex_seriesct'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Last Series Number Used%</span>
0223 ex_hdr = setfield(ex_hdr, <span class="string">'ex_numarch'</span>, fread(fid,1,<span class="string">'int32'</span>));     <span class="comment">%Number of Series Archived%</span>
0224 ex_hdr = setfield(ex_hdr, <span class="string">'ex_numseries'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">%Number of Series Existing%</span>
0225 ex_hdr = setfield(ex_hdr, <span class="string">'ex_series'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0226     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>)));  <span class="comment">%Series Keys for this Exam%</span>
0227 ex_hdr = setfield(ex_hdr, <span class="string">'ex_numunser'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Number of Unstored Series%</span>
0228 ex_hdr = setfield(ex_hdr, <span class="string">'ex_unseries'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0229     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>)));    <span class="comment">%Unstored Series Keys for this Exam%</span>
0230 ex_hdr = setfield(ex_hdr, <span class="string">'ex_toarchcnt'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">%Number of Unarchived Series%</span>
0231 ex_hdr = setfield(ex_hdr, <span class="string">'ex_toarchive'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0232     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>)));     <span class="comment">%Unarchived Series Keys for this Exam%</span>
0233 ex_hdr = setfield(ex_hdr, <span class="string">'ex_prospcnt'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Number of Prospective/Scout Series%</span>
0234 ex_hdr = setfield(ex_hdr, <span class="string">'ex_prosp'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0235     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>))); <span class="comment">%Prospective/Scout Series Keys for this Exam%</span>
0236 ex_hdr = setfield(ex_hdr, <span class="string">'ex_modelnum'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Last Model Number used%</span>
0237 ex_hdr = setfield(ex_hdr, <span class="string">'ex_modelcnt'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">%Number of ThreeD Models%</span>
0238 ex_hdr = setfield(ex_hdr, <span class="string">'ex_models'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0239     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>)));  <span class="comment">%ThreeD Model Keys for Exam%</span>
0240 ex_hdr = setfield(ex_hdr, <span class="string">'ex_stat'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Patient Status%</span>
0241 ex_hdr = setfield(ex_hdr, <span class="string">'uniq_sys_id'</span>, fread(fid,16,<span class="string">'uchar'</span>));   <span class="comment">%Unique System ID%</span>
0242 ex_hdr = setfield(ex_hdr, <span class="string">'service_id'</span>, fread(fid,16,<span class="string">'uchar'</span>));    <span class="comment">%Unique Service ID%</span>
0243 ex_hdr = setfield(ex_hdr, <span class="string">'mobile_loc'</span>, fread(fid,4,<span class="string">'uchar'</span>));     <span class="comment">%Mobile Location Number%</span>
0244 ex_hdr = setfield(ex_hdr, <span class="string">'study_uid'</span>, fread(fid,32,<span class="string">'uchar'</span>));     <span class="comment">%Study Entity Unique ID%</span>
0245 ex_hdr = setfield(ex_hdr, <span class="string">'study_status'</span>, fread(fid,1,<span class="string">'int16'</span>));   <span class="comment">%indicates if study has complete info(DICOM/genesis)%</span>
0246 ex_hdr = setfield(ex_hdr, <span class="string">'ex_padding'</span>, fread(fid,516,<span class="string">'uchar'</span>));   <span class="comment">%Spare Space%</span>
0247 <span class="keyword">if</span> byte_align; fseek(fid,4,0); <span class="keyword">end</span> <span class="comment">% byte alignment</span>
0248 
0249 <span class="keyword">return</span>
0250 
0251 
0252 
0253 
0254 
0255 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0256 
0257 <a name="_sub3" href="#_subfunctions" class="code">function se_hdr = ge_readHeaderSeries(fid, byte_align)</a>
0258 
0259 <span class="comment">% returns the series header as a structure.</span>
0260 <span class="comment">% if byte_align = 1 then 32-bit alignment (SGI, LX2 format)</span>
0261 <span class="comment">% if byte_align = 0 then 16-bit alignment (Sun, 5.X format)</span>
0262 
0263 <span class="comment">% define the structure and read in the data</span>
0264 <span class="comment">% to overcome the byte alignment problems</span>
0265 <span class="comment">% break up the assignment into pieces using the setfield function</span>
0266 se_hdr = struct(<span class="string">'se_suid'</span>, fread(fid,4,<span class="string">'uchar'</span>));                       <span class="comment">%Suite ID for this Series%</span>
0267 se_hdr = setfield(se_hdr, <span class="string">'se_uniq'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%The Make-Unique Flag%</span>
0268 se_hdr = setfield(se_hdr, <span class="string">'se_diskid'</span>, fread(fid,1,<span class="string">'uchar'</span>));          <span class="comment">%Disk ID for this Series%</span>
0269 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0270 se_hdr = setfield(se_hdr, <span class="string">'se_exno'</span>, fread(fid,1,<span class="string">'uint16'</span>));            <span class="comment">%Exam Number%</span>
0271 se_hdr = setfield(se_hdr, <span class="string">'se_no '</span>, fread(fid,1,<span class="string">'int16'</span>));              <span class="comment">%Series Number%</span>
0272 se_hdr = setfield(se_hdr, <span class="string">'se_datetime'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Allocation Series Data/Time stamp%</span>
0273 se_hdr = setfield(se_hdr, <span class="string">'se_actual_dt'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Actual Series Data/Time stamp%</span>
0274 se_hdr = setfield(se_hdr, <span class="string">'se_desc'</span>, fread(fid,30,<span class="string">'uchar'</span>));       <span class="comment">%Series Description%</span>
0275 se_hdr = setfield(se_hdr, <span class="string">'pr_sysid'</span>, fread(fid,9,<span class="string">'uchar'</span>));       <span class="comment">%Primary Receiver Suite and Host%</span>
0276 se_hdr = setfield(se_hdr, <span class="string">'pansysid'</span>, fread(fid,9,<span class="string">'uchar'</span>));       <span class="comment">%Archiver Suite and Host%</span>
0277 se_hdr = setfield(se_hdr, <span class="string">'se_typ '</span>, fread(fid,1,<span class="string">'int16'</span>));             <span class="comment">%Series Type%</span>
0278 se_hdr = setfield(se_hdr, <span class="string">'se_source '</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Series from which prescribed%</span>
0279 se_hdr = setfield(se_hdr, <span class="string">'se_plane '</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Most-like Plane (for L/S)%</span>
0280 se_hdr = setfield(se_hdr, <span class="string">'scan_type '</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Scout or Axial (for CT)%</span>
0281 se_hdr = setfield(se_hdr, <span class="string">'position'</span>, fread(fid,1,<span class="string">'int32'</span>));           <span class="comment">%Patient Position%</span>
0282 se_hdr = setfield(se_hdr, <span class="string">'entry'</span>, fread(fid,1,<span class="string">'int32'</span>));              <span class="comment">%Patient Entry%</span>
0283 se_hdr = setfield(se_hdr, <span class="string">'anref'</span>, fread(fid,3,<span class="string">'uchar'</span>));          <span class="comment">%Anatomical reference%</span>
0284 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0285 se_hdr = setfield(se_hdr, <span class="string">'lmhor'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%Horizontal Landmark%</span>
0286 se_hdr = setfield(se_hdr, <span class="string">'prtcl'</span>, fread(fid,25,<span class="string">'uchar'</span>));         <span class="comment">%Scan Protocol Name%</span>
0287 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0288 se_hdr = setfield(se_hdr, <span class="string">'se_contrast '</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Non-zero if &gt; 0 image used contrast(L/S)%</span>
0289 se_hdr = setfield(se_hdr, <span class="string">'start_ras'</span>, fread(fid,1,<span class="string">'uchar'</span>));          <span class="comment">%RAS letter for first scan location (L/S)%</span>
0290 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0291 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0292 se_hdr = setfield(se_hdr, <span class="string">'start_loc'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%First scan location (L/S)%</span>
0293 se_hdr = setfield(se_hdr, <span class="string">'end_ras'</span>, fread(fid,1,<span class="string">'uchar'</span>));            <span class="comment">%RAS letter for last scan location (L/S)%</span>
0294 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0295 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0296 se_hdr = setfield(se_hdr, <span class="string">'end_loc'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%Last scan location (L/S)%</span>
0297 se_hdr = setfield(se_hdr, <span class="string">'se_pseq '</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Last Pulse Sequence Used (L/S)%</span>
0298 se_hdr = setfield(se_hdr, <span class="string">'se_sortorder '</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%Image Sort Order (L/S)%</span>
0299 se_hdr = setfield(se_hdr, <span class="string">'se_lndmrkcnt'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Landmark Counter%</span>
0300 se_hdr = setfield(se_hdr, <span class="string">'se_nacq '</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Number of Acquisitions%</span>
0301 se_hdr = setfield(se_hdr, <span class="string">'xbasest '</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Starting number for baselines%</span>
0302 se_hdr = setfield(se_hdr, <span class="string">'xbaseend'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Ending number for baselines%</span>
0303 se_hdr = setfield(se_hdr, <span class="string">'xenhst'</span>, fread(fid,1,<span class="string">'int16'</span>));             <span class="comment">%Starting number for enhanced scans%</span>
0304 se_hdr = setfield(se_hdr, <span class="string">'xenhend'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Ending number for enhanced scans%</span>
0305 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0306 se_hdr = setfield(se_hdr, <span class="string">'se_lastmod'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Date/Time of Last Change%</span>
0307 se_hdr = setfield(se_hdr, <span class="string">'se_alloc_key'</span>, fread(fid,13,<span class="string">'uchar'</span>));  <span class="comment">%Process that allocated this record%</span>
0308 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0309 <span class="keyword">if</span> byte_align; fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0310 se_hdr = setfield(se_hdr, <span class="string">'se_delta_cnt'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Indicates number of updates to header%</span>
0311 se_hdr = setfield(se_hdr, <span class="string">'se_verscre'</span>, fread(fid,2,<span class="string">'uchar'</span>));     <span class="comment">%Genesis Version - Created%</span>
0312 se_hdr = setfield(se_hdr, <span class="string">'se_verscur'</span>, fread(fid,2,<span class="string">'uchar'</span>));     <span class="comment">%Genesis Version - Now%</span>
0313 se_hdr = setfield(se_hdr, <span class="string">'se_pds_a'</span>, fread(fid,1,<span class="string">'float32'</span>));           <span class="comment">%PixelData size - as stored%</span>
0314 se_hdr = setfield(se_hdr, <span class="string">'se_pds_c'</span>, fread(fid,1,<span class="string">'float32'</span>));           <span class="comment">%PixelData size - Compressed%</span>
0315 se_hdr = setfield(se_hdr, <span class="string">'se_pds_u'</span>, fread(fid,1,<span class="string">'float32'</span>));           <span class="comment">%PixelData size - UnCompressed%</span>
0316 se_hdr = setfield(se_hdr, <span class="string">'se_checksum'</span>, fread(fid,1,<span class="string">'uint32'</span>));        <span class="comment">%Series Record checksum%</span>
0317 se_hdr = setfield(se_hdr, <span class="string">'se_complete'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Series Complete Flag%</span>
0318 se_hdr = setfield(se_hdr, <span class="string">'se_numarch'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Number of Images Archived%</span>
0319 se_hdr = setfield(se_hdr, <span class="string">'se_imagect'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Last Image Number Used%</span>
0320 se_hdr = setfield(se_hdr, <span class="string">'se_numimages'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Number of Images Existing%</span>
0321 se_hdr = setfield(se_hdr, <span class="string">'se_images'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0322     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>))); <span class="comment">%Image Keys for this Series%</span>
0323 se_hdr = setfield(se_hdr, <span class="string">'se_numunimg'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Number of Unstored Images%</span>
0324 se_hdr = setfield(se_hdr, <span class="string">'se_unimages'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0325     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>))); <span class="comment">%Unstored Image Keys for this Series%</span>
0326 se_hdr = setfield(se_hdr, <span class="string">'se_toarchcnt'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Number of Unarchived Images%</span>
0327 se_hdr = setfield(se_hdr, <span class="string">'se_toarchive'</span>, struct(<span class="string">'length'</span>, fread(fid,1,<span class="string">'uint32'</span>), <span class="keyword">...</span>
0328     <span class="string">'data'</span>, fread(fid,1,<span class="string">'uint32'</span>))); <span class="comment">%Unarchived Image Keys for this Series%</span>
0329 se_hdr = setfield(se_hdr, <span class="string">'echo1_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 1 Alpha Value%</span>
0330 se_hdr = setfield(se_hdr, <span class="string">'echo1_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 1 Beta Value%</span>
0331 se_hdr = setfield(se_hdr, <span class="string">'echo1_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 1 Window Value%</span>
0332 se_hdr = setfield(se_hdr, <span class="string">'echo1_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 1 Level Value%</span>
0333 se_hdr = setfield(se_hdr, <span class="string">'echo2_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 2 Alpha Value%</span>
0334 se_hdr = setfield(se_hdr, <span class="string">'echo2_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 2 Beta Value%</span>
0335 se_hdr = setfield(se_hdr, <span class="string">'echo2_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 2 Window Value%</span>
0336 se_hdr = setfield(se_hdr, <span class="string">'echo2_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 2 Level Value%</span>
0337 se_hdr = setfield(se_hdr, <span class="string">'echo3_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 3 Alpha Value%</span>
0338 se_hdr = setfield(se_hdr, <span class="string">'echo3_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 3 Beta Value%</span>
0339 se_hdr = setfield(se_hdr, <span class="string">'echo3_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 3 Window Value%</span>
0340 se_hdr = setfield(se_hdr, <span class="string">'echo3_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 3 Level Value%</span>
0341 se_hdr = setfield(se_hdr, <span class="string">'echo4_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 4 Alpha Value%</span>
0342 se_hdr = setfield(se_hdr, <span class="string">'echo4_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 4 Beta Value%</span>
0343 se_hdr = setfield(se_hdr, <span class="string">'echo4_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 4 Window Value%</span>
0344 se_hdr = setfield(se_hdr, <span class="string">'echo4_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 4 Level Value%</span>
0345 se_hdr = setfield(se_hdr, <span class="string">'echo5_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 5 Alpha Value%</span>
0346 se_hdr = setfield(se_hdr, <span class="string">'echo5_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 5 Beta Value%</span>
0347 se_hdr = setfield(se_hdr, <span class="string">'echo5_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 5 Window Value%</span>
0348 se_hdr = setfield(se_hdr, <span class="string">'echo5_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 5 Level Value%</span>
0349 se_hdr = setfield(se_hdr, <span class="string">'echo6_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 6 Alpha Value%</span>
0350 se_hdr = setfield(se_hdr, <span class="string">'echo6_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 6 Beta Value%</span>
0351 se_hdr = setfield(se_hdr, <span class="string">'echo6_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 6 Window Value%</span>
0352 se_hdr = setfield(se_hdr, <span class="string">'echo6_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 6 Level Value%</span>
0353 se_hdr = setfield(se_hdr, <span class="string">'echo7_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 7 Alpha Value%</span>
0354 se_hdr = setfield(se_hdr, <span class="string">'echo7_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 7 Beta Value%</span>
0355 se_hdr = setfield(se_hdr, <span class="string">'echo7_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 7 Window Value%</span>
0356 se_hdr = setfield(se_hdr, <span class="string">'echo7_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 7 Level Value%</span>
0357 se_hdr = setfield(se_hdr, <span class="string">'echo8_alpha'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Echo 8 Alpha Value%</span>
0358 se_hdr = setfield(se_hdr, <span class="string">'echo8_beta'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Echo 8 Beta Value%</span>
0359 se_hdr = setfield(se_hdr, <span class="string">'echo8_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));       <span class="comment">%Echo 8 Window Value%</span>
0360 se_hdr = setfield(se_hdr, <span class="string">'echo8_level'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Echo 8 Level Value%</span>
0361 se_hdr = setfield(se_hdr, <span class="string">'series_uid'</span>, fread(fid,32,<span class="string">'uchar'</span>));    <span class="comment">%Series Entity Unique ID%</span>
0362 se_hdr = setfield(se_hdr, <span class="string">'landmark_uid'</span>, fread(fid,32,<span class="string">'uchar'</span>));  <span class="comment">%Landmark Unique ID%</span>
0363 se_hdr = setfield(se_hdr, <span class="string">'equipmnt_uid'</span>, fread(fid,32,<span class="string">'uchar'</span>));  <span class="comment">%Equipment Unique ID%</span>
0364 se_hdr = setfield(se_hdr, <span class="string">'se_padding'</span>, fread(fid,588,<span class="string">'uchar'</span>));   <span class="comment">%Spare Space%</span>
0365 
0366 <span class="keyword">return</span>
0367 
0368 
0369 
0370 
0371 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0372 
0373 <a name="_sub4" href="#_subfunctions" class="code">function im_hdr = ge_readHeaderImage(fid, byte_align)</a>
0374 
0375 <span class="comment">% returns the image header as a structure.</span>
0376 <span class="comment">% if byte_align = 1 then 32-bit alignment (SGI, LX2 format)</span>
0377 <span class="comment">% if byte_align = 0 then 16-bit alignment (Sun, 5.X format)</span>
0378 
0379 <span class="comment">% define the structure and read in the data</span>
0380 <span class="comment">% to overcome the byte alignment problems</span>
0381 <span class="comment">% break up the assignment into pieces using the setfield function</span>
0382 
0383 im_hdr = struct(<span class="string">'im_suid'</span>, fread(fid,4,<span class="string">'uchar'</span>)); <span class="comment">%Suite id for this image</span>
0384 im_hdr = setfield(im_hdr, <span class="string">'im_uniq'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%The Make-Unique Flag</span>
0385 im_hdr = setfield(im_hdr, <span class="string">'im_diskid'</span>, fread(fid,1,<span class="string">'uchar'</span>));          <span class="comment">%Disk ID for this Image</span>
0386 fseek(fid, 1, 0);<span class="comment">% 16-bit alignment</span>
0387 im_hdr = setfield(im_hdr, <span class="string">'im_exno'</span>, fread(fid,1,<span class="string">'uint16'</span>));            <span class="comment">%Exam number for this image</span>
0388 im_hdr = setfield(im_hdr, <span class="string">'im_seno'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Series Number for this image</span>
0389 im_hdr = setfield(im_hdr, <span class="string">'im_no'</span>, fread(fid,1,<span class="string">'int16'</span>));              <span class="comment">%Image Number</span>
0390 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0391 im_hdr = setfield(im_hdr, <span class="string">'im_datetime'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Allocation Image date/time stamp</span>
0392 im_hdr = setfield(im_hdr, <span class="string">'im_actual_dt'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%Actual Image date/time stamp</span>
0393 im_hdr = setfield(im_hdr, <span class="string">'sctime'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Duration of scan</span>
0394 im_hdr = setfield(im_hdr, <span class="string">'slthick'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%Slice Thickness (mm)</span>
0395 im_hdr = setfield(im_hdr, <span class="string">'imatrix_X'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Image matrix size - X</span>
0396 im_hdr = setfield(im_hdr, <span class="string">'imatrix_Y'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Image matrix size - Y</span>
0397 im_hdr = setfield(im_hdr, <span class="string">'dfov'</span>, fread(fid,1,<span class="string">'float32'</span>));               <span class="comment">%Display field of view - X (mm)</span>
0398 im_hdr = setfield(im_hdr, <span class="string">'dfov_rect'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%Display field of view - Y (if different)</span>
0399 im_hdr = setfield(im_hdr, <span class="string">'dim_X'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%Image dimension - X</span>
0400 im_hdr = setfield(im_hdr, <span class="string">'dim_Y'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%Image dimension - Y</span>
0401 im_hdr = setfield(im_hdr, <span class="string">'pixsize_X'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%Image pixel size - X</span>
0402 im_hdr = setfield(im_hdr, <span class="string">'pixsize_Y'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%Image pixel size - Y</span>
0403 im_hdr = setfield(im_hdr, <span class="string">'pdid'</span>, fread(fid,14,<span class="string">'uchar'</span>));          <span class="comment">%Pixel Data ID</span>
0404 im_hdr = setfield(im_hdr, <span class="string">'contrastIV'</span>, fread(fid,17,<span class="string">'uchar'</span>));    <span class="comment">%IV Contrast Agent</span>
0405 im_hdr = setfield(im_hdr, <span class="string">'contrastOral'</span>, fread(fid,17,<span class="string">'uchar'</span>));  <span class="comment">%Oral Contrast Agent</span>
0406 im_hdr = setfield(im_hdr, <span class="string">'contmode'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Image Contrast Mode</span>
0407 im_hdr = setfield(im_hdr, <span class="string">'serrx'</span>, fread(fid,1,<span class="string">'int16'</span>));              <span class="comment">%Series from which prescribed</span>
0408 im_hdr = setfield(im_hdr, <span class="string">'imgrx'</span>, fread(fid,1,<span class="string">'int16'</span>));              <span class="comment">%Image from which prescribed</span>
0409 im_hdr = setfield(im_hdr, <span class="string">'screenformat'</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%Screen Format(8/16 bit)</span>
0410 im_hdr = setfield(im_hdr, <span class="string">'plane'</span>, fread(fid,1,<span class="string">'int16'</span>));              <span class="comment">%Plane Type</span>
0411 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0412 im_hdr = setfield(im_hdr, <span class="string">'scanspacing'</span>, fread(fid,1,<span class="string">'float32'</span>));        <span class="comment">%Spacing between scans (mm?)</span>
0413 im_hdr = setfield(im_hdr, <span class="string">'im_compress'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Image compression type for allocation</span>
0414 im_hdr = setfield(im_hdr, <span class="string">'im_scouttype'</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%Scout Type (AP or lateral)</span>
0415 im_hdr = setfield(im_hdr, <span class="string">'loc_ras'</span>, fread(fid,1,<span class="string">'uchar'</span>));            <span class="comment">%RAS letter of image location</span>
0416 fseek(fid, 1, 0); <span class="comment">% 16-bit alignment</span>
0417 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0418 im_hdr = setfield(im_hdr, <span class="string">'loc'</span>, fread(fid,1,<span class="string">'float32'</span>));                <span class="comment">%Image location</span>
0419 im_hdr = setfield(im_hdr, <span class="string">'ctr_R'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%Center R coord of plane image</span>
0420 im_hdr = setfield(im_hdr, <span class="string">'ctr_A'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%Center A coord of plane image</span>
0421 im_hdr = setfield(im_hdr, <span class="string">'ctr_S'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%Center S coord of plane image</span>
0422 im_hdr = setfield(im_hdr, <span class="string">'norm_R'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Normal R coord</span>
0423 im_hdr = setfield(im_hdr, <span class="string">'norm_A'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Normal A coord</span>
0424 im_hdr = setfield(im_hdr, <span class="string">'norm_S'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Normal S coord</span>
0425 im_hdr = setfield(im_hdr, <span class="string">'tlhc_R'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%R Coord of Top Left Hand Corner</span>
0426 im_hdr = setfield(im_hdr, <span class="string">'tlhc_A'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%A Coord of Top Left Hand Corner</span>
0427 im_hdr = setfield(im_hdr, <span class="string">'tlhc_S'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%S Coord of Top Left Hand Corner</span>
0428 im_hdr = setfield(im_hdr, <span class="string">'trhc_R'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%R Coord of Top Right Hand Corner</span>
0429 im_hdr = setfield(im_hdr, <span class="string">'trhc_A'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%A Coord of Top Right Hand Corner</span>
0430 im_hdr = setfield(im_hdr, <span class="string">'trhc_S'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%S Coord of Top Right Hand Corner</span>
0431 im_hdr = setfield(im_hdr, <span class="string">'brhc_R'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%R Coord of Bottom Right Hand Corner</span>
0432 im_hdr = setfield(im_hdr, <span class="string">'brhc_A'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%A Coord of Bottom Right Hand Corner</span>
0433 im_hdr = setfield(im_hdr, <span class="string">'brhc_S'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%S Coord of Bottom Right Hand Corner</span>
0434 im_hdr = setfield(im_hdr, <span class="string">'forimgrev'</span>, fread(fid,4,<span class="string">'uchar'</span>));      <span class="comment">%Foreign Image Revision</span>
0435 im_hdr = setfield(im_hdr, <span class="string">'tr'</span>, fread(fid,1,<span class="string">'int32'</span>));                 <span class="comment">%Pulse repetition time(usec)</span>
0436 im_hdr = setfield(im_hdr, <span class="string">'ti'</span>, fread(fid,1,<span class="string">'int32'</span>));                 <span class="comment">%Pulse inversion time(usec)</span>
0437 im_hdr = setfield(im_hdr, <span class="string">'te'</span>, fread(fid,1,<span class="string">'int32'</span>));                 <span class="comment">%Pulse echo time(usec)</span>
0438 im_hdr = setfield(im_hdr, <span class="string">'te2'</span>, fread(fid,1,<span class="string">'int32'</span>));                <span class="comment">%Second echo echo (usec)</span>
0439 im_hdr = setfield(im_hdr, <span class="string">'numecho'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Number of echoes</span>
0440 im_hdr = setfield(im_hdr, <span class="string">'echonum'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Echo Number</span>
0441 im_hdr = setfield(im_hdr, <span class="string">'tbldlta'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%Table Delta</span>
0442 im_hdr = setfield(im_hdr, <span class="string">'nex'</span>, fread(fid,1,<span class="string">'float32'</span>));                <span class="comment">%Number of Excitations</span>
0443 im_hdr = setfield(im_hdr, <span class="string">'contig'</span>, fread(fid,1,<span class="string">'int16'</span>));             <span class="comment">%Continuous Slices Flag</span>
0444 im_hdr = setfield(im_hdr, <span class="string">'hrtrate'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Cardiac Heart Rate (bpm)</span>
0445 im_hdr = setfield(im_hdr, <span class="string">'tdel'</span>, fread(fid,1,<span class="string">'int32'</span>));               <span class="comment">%Delay time after trigger (msec)</span>
0446 im_hdr = setfield(im_hdr, <span class="string">'saravg'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Average SAR</span>
0447 im_hdr = setfield(im_hdr, <span class="string">'sarpeak'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%Peak SAR</span>
0448 im_hdr = setfield(im_hdr, <span class="string">'monsar'</span>, fread(fid,1,<span class="string">'int16'</span>));             <span class="comment">%Monitor SAR flag</span>
0449 im_hdr = setfield(im_hdr, <span class="string">'trgwindow'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Trigger window (% of R-R interval)</span>
0450 im_hdr = setfield(im_hdr, <span class="string">'reptime'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%Cardiac repetition time</span>
0451 im_hdr = setfield(im_hdr, <span class="string">'imgpcyc'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Images per cardiac cycle</span>
0452 im_hdr = setfield(im_hdr, <span class="string">'xmtgain'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Actual Transmit Gain (.1 db)</span>
0453 im_hdr = setfield(im_hdr, <span class="string">'rcvgain1'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Actual Receive Gain Analog (.1 db)</span>
0454 im_hdr = setfield(im_hdr, <span class="string">'rcvgain2'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Actual Receive Gain Digital (.1 db)</span>
0455 im_hdr = setfield(im_hdr, <span class="string">'mr_flip'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Flip Angle for GRASS scans (deg.)</span>
0456 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% byte alignment</span>
0457 im_hdr = setfield(im_hdr, <span class="string">'mindat'</span>, fread(fid,1,<span class="string">'int32'</span>));             <span class="comment">%Minimum Delay after Trigger (uSec)</span>
0458 im_hdr = setfield(im_hdr, <span class="string">'cphase'</span>, fread(fid,1,<span class="string">'int16'</span>));             <span class="comment">%Total Cardiac Phase prescribed</span>
0459 im_hdr = setfield(im_hdr, <span class="string">'swappf'</span>, fread(fid,1,<span class="string">'int16'</span>));             <span class="comment">%Swap Phase/Frequency Axis</span>
0460 im_hdr = setfield(im_hdr, <span class="string">'pauseint'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Pause Interval (slices)</span>
0461 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0462 im_hdr = setfield(im_hdr, <span class="string">'pausetime'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%Pause Time</span>
0463 im_hdr = setfield(im_hdr, <span class="string">'obplane'</span>, fread(fid,1,<span class="string">'int32'</span>));            <span class="comment">%Oblique Plane</span>
0464 im_hdr = setfield(im_hdr, <span class="string">'slocfov'</span>, fread(fid,1,<span class="string">'int32'</span>));            <span class="comment">%Slice Offsets on Freq axis</span>
0465 im_hdr = setfield(im_hdr, <span class="string">'xmtfreq'</span>, fread(fid,1,<span class="string">'int32'</span>));            <span class="comment">%Center Frequency (0.1 Hz)</span>
0466 im_hdr = setfield(im_hdr, <span class="string">'autoxmtfreq'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Auto Center Frequency (0.1 Hz)</span>
0467 im_hdr = setfield(im_hdr, <span class="string">'autoxmtgain'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Auto Transmit Gain (0.1 dB)</span>
0468 im_hdr = setfield(im_hdr, <span class="string">'prescan_r1'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%PreScan R1 - Analog</span>
0469 im_hdr = setfield(im_hdr, <span class="string">'prescan_r2'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%PreScan R2 - Digital</span>
0470 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0471 im_hdr = setfield(im_hdr, <span class="string">'user_bitmap'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Bitmap defining user CVs</span>
0472 im_hdr = setfield(im_hdr, <span class="string">'cenfreq'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Center Frequency Method</span>
0473 im_hdr = setfield(im_hdr, <span class="string">'imode'</span>, fread(fid,1,<span class="string">'int16'</span>));              <span class="comment">%Imaging Mode</span>
0474 im_hdr = setfield(im_hdr, <span class="string">'iopt'</span>, fread(fid,1,<span class="string">'int32'</span>));               <span class="comment">%Imaging Options</span>
0475 im_hdr = setfield(im_hdr, <span class="string">'pseq'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%Pulse Sequence</span>
0476 im_hdr = setfield(im_hdr, <span class="string">'pseqmode'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Pulse Sequence Mode</span>
0477 im_hdr = setfield(im_hdr, <span class="string">'psdname'</span>, fread(fid,33,<span class="string">'uchar'</span>));       <span class="comment">%Pulse Sequence Name</span>
0478 fseek(fid,1,0); <span class="comment">% 16-bit alignment</span>
0479 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% byte alignment</span>
0480 im_hdr = setfield(im_hdr, <span class="string">'psd_datetime'</span>, fread(fid,1,<span class="string">'int32'</span>));       <span class="comment">%PSD Creation Date and Time</span>
0481 im_hdr = setfield(im_hdr, <span class="string">'psd_iname'</span>, fread(fid,13,<span class="string">'uchar'</span>));     <span class="comment">%PSD name from inside PSD</span>
0482 fseek(fid, 1, 0); <span class="comment">% 16-bit alignment</span>
0483 im_hdr = setfield(im_hdr, <span class="string">'ctyp'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%Coil Type</span>
0484 im_hdr = setfield(im_hdr, <span class="string">'cname'</span>, fread(fid,17,<span class="string">'uchar'</span>));         <span class="comment">%Coil Name</span>
0485 fseek(fid, 1, 0); <span class="comment">% 16-bit alignment</span>
0486 im_hdr = setfield(im_hdr, <span class="string">'surfctyp'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Surface Coil Type</span>
0487 im_hdr = setfield(im_hdr, <span class="string">'surfcext'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Extremity Coil Flag</span>
0488 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0489 im_hdr = setfield(im_hdr, <span class="string">'rawrunnum'</span>, fread(fid,1,<span class="string">'int32'</span>));          <span class="comment">%RawData Run Number</span>
0490 im_hdr = setfield(im_hdr, <span class="string">'cal_fldstr'</span>, fread(fid,1,<span class="string">'uint32'</span>));         <span class="comment">%Calibrated Field Strength (x10 uGauss)</span>
0491 im_hdr = setfield(im_hdr, <span class="string">'supp_tech'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%SAT fat/water/none</span>
0492 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0493 im_hdr = setfield(im_hdr, <span class="string">'vbw'</span>, fread(fid,1,<span class="string">'float32'</span>));                <span class="comment">%Variable Bandwidth (Hz)</span>
0494 im_hdr = setfield(im_hdr, <span class="string">'slquant'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Number of slices in this scan group</span>
0495 im_hdr = setfield(im_hdr, <span class="string">'gpre'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%Graphically prescribed</span>
0496 im_hdr = setfield(im_hdr, <span class="string">'intr_del'</span>, fread(fid,1,<span class="string">'int32'</span>));           <span class="comment">%Interimage/interloc delay (uSec)</span>
0497 im_hdr = setfield(im_hdr, <span class="string">'user0'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 0</span>
0498 im_hdr = setfield(im_hdr, <span class="string">'user1'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 1</span>
0499 im_hdr = setfield(im_hdr, <span class="string">'user2'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 2</span>
0500 im_hdr = setfield(im_hdr, <span class="string">'user3'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 3</span>
0501 im_hdr = setfield(im_hdr, <span class="string">'user4'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 4</span>
0502 im_hdr = setfield(im_hdr, <span class="string">'user5'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 5</span>
0503 im_hdr = setfield(im_hdr, <span class="string">'user6'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 6</span>
0504 im_hdr = setfield(im_hdr, <span class="string">'user7'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 7</span>
0505 im_hdr = setfield(im_hdr, <span class="string">'user8'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 8</span>
0506 im_hdr = setfield(im_hdr, <span class="string">'user9'</span>, fread(fid,1,<span class="string">'float32'</span>));              <span class="comment">%User Variable 9</span>
0507 im_hdr = setfield(im_hdr, <span class="string">'user10'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 10</span>
0508 im_hdr = setfield(im_hdr, <span class="string">'user11'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 11</span>
0509 im_hdr = setfield(im_hdr, <span class="string">'user12'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 12</span>
0510 im_hdr = setfield(im_hdr, <span class="string">'user13'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 13</span>
0511 im_hdr = setfield(im_hdr, <span class="string">'user14'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 14</span>
0512 im_hdr = setfield(im_hdr, <span class="string">'user15'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 15</span>
0513 im_hdr = setfield(im_hdr, <span class="string">'user16'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 16</span>
0514 im_hdr = setfield(im_hdr, <span class="string">'user17'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 17</span>
0515 im_hdr = setfield(im_hdr, <span class="string">'user18'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 18</span>
0516 im_hdr = setfield(im_hdr, <span class="string">'user19'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 19</span>
0517 im_hdr = setfield(im_hdr, <span class="string">'user20'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 20</span>
0518 im_hdr = setfield(im_hdr, <span class="string">'user21'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 21</span>
0519 im_hdr = setfield(im_hdr, <span class="string">'user22'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 22</span>
0520 im_hdr = setfield(im_hdr, <span class="string">'user23'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Projection Angle</span>
0521 im_hdr = setfield(im_hdr, <span class="string">'user24'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%Concat Sat Type Flag</span>
0522 im_hdr = setfield(im_hdr, <span class="string">'im_alloc_key'</span>, fread(fid,13,<span class="string">'uchar'</span>));
0523 fseek(fid, 1, 0); <span class="comment">% 16-bit alignment</span>
0524 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0525 im_hdr = setfield(im_hdr, <span class="string">'im_lastmod'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Date/Time of Last Change</span>
0526 im_hdr = setfield(im_hdr, <span class="string">'im_verscre'</span>, fread(fid,2,<span class="string">'uchar'</span>));     <span class="comment">%Genesis Version - Created</span>
0527 im_hdr = setfield(im_hdr, <span class="string">'im_verscur'</span>, fread(fid,2,<span class="string">'uchar'</span>));     <span class="comment">%Genesis Version - Now</span>
0528 im_hdr = setfield(im_hdr, <span class="string">'im_pds_a'</span>, fread(fid,1,<span class="string">'int32'</span>));           <span class="comment">%PixelData size - as stored</span>
0529 im_hdr = setfield(im_hdr, <span class="string">'im_pds_c'</span>, fread(fid,1,<span class="string">'int32'</span>));           <span class="comment">%PixelData size - Compressed</span>
0530 im_hdr = setfield(im_hdr, <span class="string">'im_pds_u'</span>, fread(fid,1,<span class="string">'int32'</span>));           <span class="comment">%PixelData size - UnCompressed</span>
0531 im_hdr = setfield(im_hdr, <span class="string">'im_checksum'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%AcqRecon record checksum</span>
0532 im_hdr = setfield(im_hdr, <span class="string">'im_archived'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Image Archive Flag</span>
0533 im_hdr = setfield(im_hdr, <span class="string">'im_complete'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Image Complete Flag</span>
0534 im_hdr = setfield(im_hdr, <span class="string">'satbits'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Bitmap of SAT selections</span>
0535 im_hdr = setfield(im_hdr, <span class="string">'scic'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%Surface Coil Intensity Correction Flag</span>
0536 im_hdr = setfield(im_hdr, <span class="string">'satxloc1'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%R-side SAT pulse loc rel to lndmrk</span>
0537 im_hdr = setfield(im_hdr, <span class="string">'satxloc2'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%L-side SAT pulse loc rel to lndmrk</span>
0538 im_hdr = setfield(im_hdr, <span class="string">'satyloc1'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%A-side SAT pulse loc rel to lndmrk</span>
0539 im_hdr = setfield(im_hdr, <span class="string">'satyloc2'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%P-side SAT pulse loc rel to lndmrk</span>
0540 im_hdr = setfield(im_hdr, <span class="string">'satzloc1'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%S-side SAT pulse loc rel to lndmrk</span>
0541 im_hdr = setfield(im_hdr, <span class="string">'satzloc2'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%I-side SAT pulse loc rel to lndmrk</span>
0542 im_hdr = setfield(im_hdr, <span class="string">'satxthick'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Thickness of X-axis SAT pulse</span>
0543 im_hdr = setfield(im_hdr, <span class="string">'satythick'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Thickness of Y-axis SAT pulse</span>
0544 im_hdr = setfield(im_hdr, <span class="string">'satzthick'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Thickness of Z-axis SAT pulse</span>
0545 im_hdr = setfield(im_hdr, <span class="string">'flax'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%Phase contrast flow axis</span>
0546 im_hdr = setfield(im_hdr, <span class="string">'venc'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%Phase contrast velocity encoding</span>
0547 im_hdr = setfield(im_hdr, <span class="string">'thk_disclmr'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%Slice Thickness</span>
0548 im_hdr = setfield(im_hdr, <span class="string">'ps_flag'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%Auto/Manual Prescan flag</span>
0549 im_hdr = setfield(im_hdr, <span class="string">'ps_status'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Bitmap of changed values</span>
0550 im_hdr = setfield(im_hdr, <span class="string">'image_type'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Magnitude, Phase, Imaginary, or Real</span>
0551 im_hdr = setfield(im_hdr, <span class="string">'vas_collapse'</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%Collapse Image</span>
0552 im_hdr = setfield(im_hdr, <span class="string">'user23n'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%User Variable 23</span>
0553 im_hdr = setfield(im_hdr, <span class="string">'user24n'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%User Variable 24</span>
0554 im_hdr = setfield(im_hdr, <span class="string">'proj_alg'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Projection Algorithm</span>
0555 im_hdr = setfield(im_hdr, <span class="string">'proj_name'</span>, fread(fid,13,<span class="string">'uchar'</span>));     <span class="comment">%Projection Algorithm Name</span>
0556 fseek(fid, 1, 0); <span class="comment">% 16-bit alignment</span>
0557 im_hdr = setfield(im_hdr, <span class="string">'x_axis_rot'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%X Axis Rotation</span>
0558 im_hdr = setfield(im_hdr, <span class="string">'y_axis_rot'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Y Axis Rotation</span>
0559 im_hdr = setfield(im_hdr, <span class="string">'z_axis_rot'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Z Axis Rotation</span>
0560 im_hdr = setfield(im_hdr, <span class="string">'thresh_min1'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Lower Range of Pixels 1</span>
0561 im_hdr = setfield(im_hdr, <span class="string">'thresh_max1'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Upper Range of Pixels 1</span>
0562 im_hdr = setfield(im_hdr, <span class="string">'thresh_min2'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Lower Range of Pixels 2</span>
0563 im_hdr = setfield(im_hdr, <span class="string">'thresh_max2'</span>, fread(fid,1,<span class="string">'int32'</span>));        <span class="comment">%Upper Range of Pixels 2</span>
0564 im_hdr = setfield(im_hdr, <span class="string">'echo_trn_len'</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%Echo Train Length for Fast Spin Echo</span>
0565 im_hdr = setfield(im_hdr, <span class="string">'frac_echo'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Fractional Echo - Effective TE Flag</span>
0566 im_hdr = setfield(im_hdr, <span class="string">'prep_pulse'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%Preporatory Pulse Option</span>
0567 im_hdr = setfield(im_hdr, <span class="string">'cphasenum'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Cardiac Phase Number</span>
0568 im_hdr = setfield(im_hdr, <span class="string">'var_echo'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Variable Echo Flag</span>
0569 im_hdr = setfield(im_hdr, <span class="string">'ref_img'</span>, fread(fid,1,<span class="string">'uchar'</span>));            <span class="comment">%Reference Image Field</span>
0570 im_hdr = setfield(im_hdr, <span class="string">'sum_img'</span>, fread(fid,1,<span class="string">'uchar'</span>));            <span class="comment">%Summary Image Field</span>
0571 im_hdr = setfield(im_hdr, <span class="string">'img_window'</span>, fread(fid,1,<span class="string">'uint16'</span>));         <span class="comment">%Window Value</span>
0572 im_hdr = setfield(im_hdr, <span class="string">'img_level'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Level Value</span>
0573 im_hdr = setfield(im_hdr, <span class="string">'slop_int_1'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Number of 3D Slabs</span>
0574 im_hdr = setfield(im_hdr, <span class="string">'slop_int_2'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Slice Locs Per 3D Slab</span>
0575 im_hdr = setfield(im_hdr, <span class="string">'slop_int_3'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%# of Slice Locs on Each Slab Which Overlap Neighbors</span>
0576 im_hdr = setfield(im_hdr, <span class="string">'slop_int_4'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Image Filtering 0.5/0.2T</span>
0577 im_hdr = setfield(im_hdr, <span class="string">'slop_int_5'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Integer Slop Field 5</span>
0578 im_hdr = setfield(im_hdr, <span class="string">'slop_float_1'</span>, fread(fid,1,<span class="string">'float32'</span>));       <span class="comment">%Float Slop Field 1</span>
0579 im_hdr = setfield(im_hdr, <span class="string">'slop_float_2'</span>, fread(fid,1,<span class="string">'float32'</span>));       <span class="comment">%Float Slop Field 2</span>
0580 im_hdr = setfield(im_hdr, <span class="string">'slop_float_3'</span>, fread(fid,1,<span class="string">'float32'</span>));       <span class="comment">%Float Slop Field 3</span>
0581 im_hdr = setfield(im_hdr, <span class="string">'slop_float_4'</span>, fread(fid,1,<span class="string">'float32'</span>));       <span class="comment">%Float Slop Field 4</span>
0582 im_hdr = setfield(im_hdr, <span class="string">'slop_float_5'</span>, fread(fid,1,<span class="string">'float32'</span>));       <span class="comment">%Float Slop Field 5</span>
0583 im_hdr = setfield(im_hdr, <span class="string">'slop_str_1'</span>, fread(fid,16,<span class="string">'uchar'</span>));    <span class="comment">%String Slop Field 1</span>
0584 im_hdr = setfield(im_hdr, <span class="string">'slop_str_2'</span>, fread(fid,16,<span class="string">'uchar'</span>));    <span class="comment">%String Slop Field 2</span>
0585 im_hdr = setfield(im_hdr, <span class="string">'scanactno'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%Scan Acquisition Number</span>
0586 im_hdr = setfield(im_hdr, <span class="string">'vasflags'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Magnitude Weighting Flag</span>
0587 im_hdr = setfield(im_hdr, <span class="string">'vencscale'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%Scale Weighted Venc</span>
0588 im_hdr = setfield(im_hdr, <span class="string">'integrity'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%GE Image Integrity</span>
0589 <span class="keyword">if</span> byte_align; fseek(fid, 2, 0); <span class="keyword">end</span> <span class="comment">% byte alignment</span>
0590 im_hdr = setfield(im_hdr, <span class="string">'fphase'</span>, fread(fid,1,<span class="string">'int32'</span>));             <span class="comment">%Number Of Phases</span>
0591 im_hdr = setfield(im_hdr, <span class="string">'freq_dir'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Frequency Direction</span>
0592 im_hdr = setfield(im_hdr, <span class="string">'vas_mode'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%Vascular Mode</span>
0593 im_hdr = setfield(im_hdr, <span class="string">'image_uid'</span>, fread(fid,32,<span class="string">'uchar'</span>));     <span class="comment">%Image Unique ID</span>
0594 im_hdr = setfield(im_hdr, <span class="string">'sop_uid'</span>, fread(fid,32,<span class="string">'uchar'</span>));       <span class="comment">%Service Obj Class Unique ID</span>
0595 im_hdr = setfield(im_hdr, <span class="string">'dont_use_1'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%This field is not used</span>
0596 im_hdr = setfield(im_hdr, <span class="string">'dont_use_2'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%This field is not used</span>
0597 im_hdr = setfield(im_hdr, <span class="string">'dont_use_3'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%This field is not used</span>
0598 im_hdr = setfield(im_hdr, <span class="string">'pscopts'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%bitmap of prescan options</span>
0599 im_hdr = setfield(im_hdr, <span class="string">'asoffsetx'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%gradient offset in X-direction</span>
0600 im_hdr = setfield(im_hdr, <span class="string">'asoffsety'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%gradient offset in Y-direction</span>
0601 im_hdr = setfield(im_hdr, <span class="string">'asoffsetz'</span>, fread(fid,1,<span class="string">'int16'</span>));          <span class="comment">%gradient offset in Z-direction</span>
0602 im_hdr = setfield(im_hdr, <span class="string">'unoriginal'</span>, fread(fid,1,<span class="string">'int16'</span>));         <span class="comment">%identifies image as original or unoriginal</span>
0603 im_hdr = setfield(im_hdr, <span class="string">'interleaves'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%number of EPI shots</span>
0604 im_hdr = setfield(im_hdr, <span class="string">'effechospace'</span>, fread(fid,1,<span class="string">'int16'</span>));       <span class="comment">%effective echo spacing for EPI</span>
0605 im_hdr = setfield(im_hdr, <span class="string">'viewsperseg'</span>, fread(fid,1,<span class="string">'int16'</span>));        <span class="comment">%views per segment</span>
0606 im_hdr = setfield(im_hdr, <span class="string">'rbpm'</span>, fread(fid,1,<span class="string">'int16'</span>));               <span class="comment">%respiratory rate, breaths per min</span>
0607 im_hdr = setfield(im_hdr, <span class="string">'rtpoint'</span>, fread(fid,1,<span class="string">'int16'</span>));            <span class="comment">%respiratory trigger point as percent of max.</span>
0608 im_hdr = setfield(im_hdr, <span class="string">'rcvrtype'</span>, fread(fid,1,<span class="string">'int16'</span>));           <span class="comment">%type of receiver used</span>
0609 im_hdr = setfield(im_hdr, <span class="string">'dbdt'</span>, fread(fid,1,<span class="string">'float32'</span>));               <span class="comment">%peak rate of change of gradient field, tesla/sec</span>
0610 im_hdr = setfield(im_hdr, <span class="string">'dbdtper'</span>, fread(fid,1,<span class="string">'float32'</span>));            <span class="comment">%limit in units of percent of theoretical curve</span>
0611 im_hdr = setfield(im_hdr, <span class="string">'estdbdtper'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%PSD estimated limit in units of percent</span>
0612 im_hdr = setfield(im_hdr, <span class="string">'estdbdtts'</span>, fread(fid,1,<span class="string">'float32'</span>));          <span class="comment">%PSD estimated limit in Teslas/sec</span>
0613 im_hdr = setfield(im_hdr, <span class="string">'saravghead'</span>, fread(fid,1,<span class="string">'float32'</span>));         <span class="comment">%Avg head SAR</span>
0614 im_hdr = setfield(im_hdr, <span class="string">'neg_scanspacing'</span>, fread(fid,1,<span class="string">'float32'</span>));    <span class="comment">%Negative scan spacing for overlap slices</span>
0615 im_hdr = setfield(im_hdr, <span class="string">'offsetfreq'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Offset Frequency - Mag.Transfer</span>
0616 im_hdr = setfield(im_hdr, <span class="string">'user_usage_tag'</span>, fread(fid,1,<span class="string">'uint32'</span>));     <span class="comment">%Defines how following user CVs are to be filled in</span>
0617 <span class="comment">%Default value = 0x00000000</span>
0618 <span class="comment">%GE range = 0x00000001 - 0x7fffffff</span>
0619 <span class="comment">%Research = 0x80000000 - 0xffffffff</span>
0620 im_hdr = setfield(im_hdr, <span class="string">'user_fill_mapMSW'</span>, fread(fid,1,<span class="string">'uint32'</span>));   <span class="comment">%Define what process fills in the user CVs, ifcc or TIR</span>
0621 im_hdr = setfield(im_hdr, <span class="string">'user_fill_mapLSW'</span>, fread(fid,1,<span class="string">'uint32'</span>));   <span class="comment">%Define what process fills in the user CVs, ifcc or TIR</span>
0622 im_hdr = setfield(im_hdr, <span class="string">'user25'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 25</span>
0623 im_hdr = setfield(im_hdr, <span class="string">'user26'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 26</span>
0624 im_hdr = setfield(im_hdr, <span class="string">'user27'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 27</span>
0625 im_hdr = setfield(im_hdr, <span class="string">'user28'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 28</span>
0626 im_hdr = setfield(im_hdr, <span class="string">'user29'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 29</span>
0627 im_hdr = setfield(im_hdr, <span class="string">'user30'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 30</span>
0628 im_hdr = setfield(im_hdr, <span class="string">'user31'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 31</span>
0629 im_hdr = setfield(im_hdr, <span class="string">'user32'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 32</span>
0630 im_hdr = setfield(im_hdr, <span class="string">'user33'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 33</span>
0631 im_hdr = setfield(im_hdr, <span class="string">'user34'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 34</span>
0632 im_hdr = setfield(im_hdr, <span class="string">'user35'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 35</span>
0633 im_hdr = setfield(im_hdr, <span class="string">'user36'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 36</span>
0634 im_hdr = setfield(im_hdr, <span class="string">'user37'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 37</span>
0635 im_hdr = setfield(im_hdr, <span class="string">'user38'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 38</span>
0636 im_hdr = setfield(im_hdr, <span class="string">'user39'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 39</span>
0637 im_hdr = setfield(im_hdr, <span class="string">'user40'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 40</span>
0638 im_hdr = setfield(im_hdr, <span class="string">'user41'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 41</span>
0639 im_hdr = setfield(im_hdr, <span class="string">'user42'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 42</span>
0640 im_hdr = setfield(im_hdr, <span class="string">'user43'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 43</span>
0641 im_hdr = setfield(im_hdr, <span class="string">'user44'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 44</span>
0642 im_hdr = setfield(im_hdr, <span class="string">'user45'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 45</span>
0643 im_hdr = setfield(im_hdr, <span class="string">'user46'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 46</span>
0644 im_hdr = setfield(im_hdr, <span class="string">'user47'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 47</span>
0645 im_hdr = setfield(im_hdr, <span class="string">'user48'</span>, fread(fid,1,<span class="string">'float32'</span>));             <span class="comment">%User Variable 48</span>
0646 im_hdr = setfield(im_hdr, <span class="string">'slop_int_6'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Integer Slop Field 6</span>
0647 im_hdr = setfield(im_hdr, <span class="string">'slop_int_7'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Integer Slop Field 7</span>
0648 im_hdr = setfield(im_hdr, <span class="string">'slop_int_8'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Integer Slop Field 8</span>
0649 im_hdr = setfield(im_hdr, <span class="string">'slop_int_9'</span>, fread(fid,1,<span class="string">'int32'</span>));         <span class="comment">%Integer Slop Field 9</span>
0650 im_hdr = setfield(im_hdr, <span class="string">'mr_padding'</span>, fread(fid,32,<span class="string">'uchar'</span>));    <span class="comment">%Spare Space</span>
0651 
0652 <span class="keyword">return</span>
0653 
0654 
0655 
0656 
0657 
0658 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0659 
0660 <a name="_sub5" href="#_subfunctions" class="code">function ge = ge_readHeaderPixel(fid, byte_align, ge)</a>
0661 
0662 <span class="comment">% returns the pixel header as a structure.</span>
0663 <span class="comment">% if byte_align = 1 then 32-bit alignment (SGI, LX2 format)</span>
0664 <span class="comment">% if byte_align = 0 then 16-bit alignment (Sun, 5.X format)</span>
0665 
0666 <span class="comment">% read magic number</span>
0667 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_magic'</span>, fread(fid,1,<span class="string">'int32'</span>));
0668 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_hdr_length'</span>, fread(fid,1,<span class="string">'int32'</span>));<span class="comment">% length of total header in bytes and</span>
0669 <span class="comment">% a byte displacement to the 'pixel data area'</span>
0670 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_width'</span>, fread(fid,1,<span class="string">'int32'</span>));  <span class="comment">% width (pixels) of image</span>
0671 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_height'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% height (pixels) of image</span>
0672 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_depth'</span>, fread(fid,1,<span class="string">'int32'</span>));  <span class="comment">% depth (1, 8, 16, or 24 bits) of pixel</span>
0673 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_compress'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">% type of compression; see IC_* below</span>
0674 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_dwindow'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% default window setting</span>
0675 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_dlevel'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% default level setting</span>
0676 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_bgshade'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% background shade to use for non-image</span>
0677 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_ovrflow'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% overflow value</span>
0678 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_undflow'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% underflow value</span>
0679 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_top_offset'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% number of blank lines at image top</span>
0680 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_bot_offset'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% number of blank lines at image bottom</span>
0681 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_version'</span>, fread(fid,1,<span class="string">'int16'</span>));    <span class="comment">% version of the header structure</span>
0682 <span class="keyword">if</span> byte_align, fseek(fid,2,0); <span class="keyword">end</span> <span class="comment">% 32-bit alignment</span>
0683 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_checksum'</span>, fread(fid,1,<span class="string">'uint16'</span>)); <span class="comment">% 16 bit end_around_carry sum of pixels</span>
0684 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_id'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">% a byte disp to unique image identifier</span>
0685 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_id'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">% byte length of unique image identifier</span>
0686 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_unpack'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">% a byte disp to 'unpack control'</span>
0687 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_unpack'</span>, fread(fid,1,<span class="string">'int32'</span>));   <span class="comment">% byte length of 'unpack control'</span>
0688 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_compress'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% a byte disp to 'compression control'</span>
0689 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_compress'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% byte length of 'compression control'</span>
0690 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_histo'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% a byte disp to 'histogram control'</span>
0691 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_histo'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% byte length of 'histogram control'</span>
0692 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_text'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% a byte disp to 'text plane data'</span>
0693 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_text'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% byte length of 'text plane data'</span>
0694 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_graphics'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% a byte disp to 'graphics plane data'</span>
0695 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_graphics'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% byte length of 'graphics plane data'</span>
0696 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_dbHdr'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% a byte disp to 'data base header data'</span>
0697 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_dbHdr'</span>, fread(fid,1,<span class="string">'int32'</span>));    <span class="comment">% byte length of 'data base header data'</span>
0698 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_levelOffset'</span>, fread(fid,1,<span class="string">'int32'</span>));<span class="comment">% value to add to stored Pixel Data values</span>
0699 <span class="comment">% to get the correct presentation value</span>
0700 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_p_user'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% byte displacement to user defined data</span>
0701 ge.hdr.pixel = setfield(ge.hdr.pixel, <span class="string">'img_l_user'</span>, fread(fid,1,<span class="string">'int32'</span>)); <span class="comment">% byte length of user defined data</span>
0702 
0703 <span class="keyword">return</span></pre></div>
<hr><address>Generated on Mon 29-Mar-2004 13:14:32 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>