<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of SaveAVWObjectMap</title>
  <meta name="keywords" content="SaveAVWObjectMap">
  <meta name="description" content="SaveAVWObjectMap ( Filename, objectmap )">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">mri_toolbox</a> &gt; SaveAVWObjectMap.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mri_toolbox&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>SaveAVWObjectMap
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>SaveAVWObjectMap ( Filename, objectmap )</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function SaveAVWObjectMap ( Filename, objectmap ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> SaveAVWObjectMap ( Filename, objectmap )
 Save the objectmap in Filename</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function SaveAVWObjectMap ( Filename, objectmap )</a>
0002 <span class="comment">% SaveAVWObjectMap ( Filename, objectmap )</span>
0003 <span class="comment">% Save the objectmap in Filename</span>
0004 
0005 fid = fopen ( Filename, <span class="string">'w'</span>, <span class="string">'b'</span> );
0006 <span class="keyword">if</span> fid &lt; 0,
0007   error ( [<span class="string">'Can not open '</span> Filename <span class="string">' for writing'</span>] );
0008 <span class="keyword">end</span>
0009 
0010 fwrite ( fid, objectmap.Version, <span class="string">'int'</span> );
0011 <span class="keyword">if</span> objectmap.Version ~= 910926
0012   error ( [<span class="string">'Unknown ObjectMap version: '</span> int2str(objectmap.Version) <span class="string">' expected 910926'</span>] );
0013 <span class="keyword">end</span>
0014 
0015 fwrite ( fid, objectmap.Width, <span class="string">'int'</span> );
0016 fwrite ( fid, objectmap.Height, <span class="string">'int'</span> );
0017 fwrite ( fid, objectmap.Depth, <span class="string">'int'</span> );
0018 fwrite ( fid, objectmap.NumberOfObjects, <span class="string">'int'</span> );
0019 
0020 <span class="keyword">for</span> o = 1:objectmap.NumberOfObjects
0021   Object = objectmap.Objects(o);
0022   N = double ( Object.Name );
0023   N = [N zeros(1,32-length(N))];
0024   fwrite ( fid, N, <span class="string">'uchar'</span> );
0025   fwrite ( fid, Object.Display, <span class="string">'int'</span> );
0026   fwrite ( fid, Object.Copy, <span class="string">'uchar'</span> );
0027   fwrite ( fid, Object.Mirror, <span class="string">'uchar'</span> );
0028   fwrite ( fid, Object.Status, <span class="string">'uchar'</span> );
0029   fwrite ( fid, Object.NUsed, <span class="string">'uchar'</span> );
0030   fwrite ( fid, Object.Shades, <span class="string">'int'</span> );
0031   fwrite ( fid, Object.StartRed, <span class="string">'int'</span> );
0032   fwrite ( fid, Object.StartGreen, <span class="string">'int'</span> );
0033   fwrite ( fid, Object.StartBlue, <span class="string">'int'</span> );
0034   fwrite ( fid, Object.EndRed, <span class="string">'int'</span> );
0035   fwrite ( fid, Object.EndGreen, <span class="string">'int'</span> );
0036   fwrite ( fid, Object.EndBlue, <span class="string">'int'</span> );
0037   fwrite ( fid, Object.XRotation, <span class="string">'int'</span> );
0038   fwrite ( fid, Object.YRotation, <span class="string">'int'</span> );
0039   fwrite ( fid, Object.ZRotation, <span class="string">'int'</span> );
0040   fwrite ( fid, Object.XShift, <span class="string">'int'</span> );
0041   fwrite ( fid, Object.YShift, <span class="string">'int'</span> );
0042   fwrite ( fid, Object.ZShift, <span class="string">'int'</span> );
0043   fwrite ( fid, Object.XCenter, <span class="string">'int'</span> );
0044   fwrite ( fid, Object.YCenter, <span class="string">'int'</span> );
0045   fwrite ( fid, Object.ZCenter, <span class="string">'int'</span> );
0046   fwrite ( fid, Object.XRotationIncrement, <span class="string">'int'</span> );
0047   fwrite ( fid, Object.YRotationIncrement, <span class="string">'int'</span> );
0048   fwrite ( fid, Object.ZRotationIncrement, <span class="string">'int'</span> );
0049   fwrite ( fid, Object.XShiftIncrement, <span class="string">'int'</span> );
0050   fwrite ( fid, Object.YShiftIncrement, <span class="string">'int'</span> );
0051   fwrite ( fid, Object.ZShiftIncrement, <span class="string">'int'</span> );
0052   fwrite ( fid, Object.XMinimum, <span class="string">'short'</span> );
0053   fwrite ( fid, Object.YMinimum, <span class="string">'short'</span> );
0054   fwrite ( fid, Object.ZMinimum, <span class="string">'short'</span> );
0055   fwrite ( fid, Object.XMaximum, <span class="string">'short'</span> );
0056   fwrite ( fid, Object.YMaximum, <span class="string">'short'</span> );
0057   fwrite ( fid, Object.ZMaximum, <span class="string">'short'</span> );
0058   fwrite ( fid, Object.Opacity, <span class="string">'float'</span> );
0059   fwrite ( fid, Object.OpacityThickness, <span class="string">'int'</span> );
0060   <span class="comment">% Dummy</span>
0061   fwrite ( fid, 0, <span class="string">'int'</span> );
0062 <span class="keyword">end</span>
0063 
0064 
0065 Output = 0;
0066 NOut = 0;
0067 
0068 <span class="comment">% RLE is done image by image</span>
0069 <span class="keyword">for</span> slice = 1:size(objectmap.Image,3)
0070   X = squeeze(objectmap.Image(:,:,slice));
0071   <span class="comment">% Write the volume run length encoded.</span>
0072   <span class="comment">% Rotate back</span>
0073   <span class="comment">% X = rot90 ( X, 2 );</span>
0074   X = X(:)';
0075   Counts = diff([ 0 find(X(1:end-1) ~= X(2:end)) length(X) ]);
0076   Values = X([ find(X(1:end-1) ~= X(2:end)) length(X) ]);
0077 
0078   <span class="keyword">for</span> idx = 1:length(Counts)
0079     Count = Counts(idx);
0080     Value = Values(idx) - 1;
0081     <span class="keyword">while</span> Count &gt;= 255
0082       fwrite ( fid, [255 Value], <span class="string">'uchar'</span> );
0083       Count = Count - 255;
0084       <span class="comment">% Output = Output + 255;</span>
0085       <span class="comment">% NOut = NOut + 1;</span>
0086     <span class="keyword">end</span>
0087     fwrite ( fid, [Count Value], <span class="string">'uchar'</span> );
0088     <span class="comment">% Output = Output + Count;</span>
0089     <span class="comment">% NOut = NOut + 1;</span>
0090   <span class="keyword">end</span>
0091 <span class="keyword">end</span>
0092 fclose ( fid );</pre></div>
<hr><address>Generated on Mon 29-Mar-2004 13:14:32 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>